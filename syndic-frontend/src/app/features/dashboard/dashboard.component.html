<section
  class="rounded-2xl border border-(--color-border) bg-(--color-surface) p-4 md:p-5 mt-4 space-y-5 shadow-[var(--shadow-elev)]"
>
@if(false){
  <header class="flex flex-wrap items-center justify-between gap-3">
    <div>
      <h2 class="text-sm md:text-base font-semibold">
        {{ "dashboard.title" | translate }}
      </h2>
      <p class="text-xs md:text-sm text-(--color-muted)">
        {{ "dashboard.subtitle" | translate }}
      </p>
    </div>

    <div class="flex items-center gap-2">
      @if (visibleItemCount()) {
      <span
        class="inline-flex items-center rounded-full border  border-(--color-border) px-2.5 py-0.5 text-[11px] text-(--color-muted)"
      >
        {{ "dashboard.count" | translate : { count: visibleItemCount() } }}
      </span>
      }
      <!-- Demo CTA: AI summary -->
      <button
        type="button"
        class="inline-flex items-center gap-1 rounded-full px-3 py-1.5 text-[11px] font-semibold bg-[color:var(--color-primary)] text-white shadow-[0_10px_25px_rgba(16,185,129,0.35)] hover:bg-[color:var(--color-primary-600)] hover:shadow-[0_14px_35px_rgba(16,185,129,0.45)] active:scale-[0.98] transition-all duration-150"
      >
        üß†
        <span>{{ "dashboard.aiSummary" | translate }}</span>
      </button>
    </div>
  </header>
  }

  @if (building) {
  <section
    class="flex flex-nowrap items-stretch gap-3 overflow-x-auto rounded-xl border  border-(--color-border) bg-[color:var(--color-bg)] p-4 transition-shadow duration-150 hover:shadow-md"
  >
    <article class="flex flex-col gap-2 min-w-[340px] shrink-0">
      <div class="flex items-start gap-3">
        <img class="h-40" src="/assets/images/269_34rueBagnolet-scaled.jpg" />
        <div class="flex flex-1 flex-col gap-2">
          <div class="flex flex-col gap-1">
            <p
              class="text-[10px] uppercase tracking-wide text-(--color-muted)"
            >
              {{ "dashboard.residence" | translate }}
            </p>
            <p class="text-base font-semibold text-(--color-text)">
              {{ building.name }}
            </p>
          </div>
          <!--
          <span
            class="w-fit rounded-full border  border-(--color-border) bg-(--color-surface) px-3 py-1 text-[11px] font-medium text-(--color-muted)"
          >
            {{
              building.managementType === "benevole"
                ? ("dashboard.management.volunteer" | translate)
                : ("dashboard.management.pro" | translate)
            }}
          </span>
          -->
          <div class="flex flex-col gap-1 text-[11px] text-(--color-muted)">

            <span
              class="inline-flex items-center gap-1 rounded-md bg-(--color-surface) px-2 py-1"
            >
             üè¢ {{ building.address }}
            </span>

            <span
              class="inline-flex items-center gap-1 rounded-md bg-(--color-surface) px-2 py-1"
            >
              üë§
              
                {{
                  "dashboard.manager"
                    | translate : { name: building.volunteerManager.name }
                }}
              
            </span>
            <span
              class="inline-flex items-center gap-1 rounded-md bg-(--color-surface) px-2 py-1"
            >
              üì®
              <span>{{ building.volunteerManager.email }}</span>
            </span>
          </div>
        </div>
      </div>

    </article>

    <article
      class="min-w-[200px] shrink-0 rounded-xl border  border-(--color-border) bg-(--color-surface) p-3 flex flex-col gap-2 transition-all duration-150 hover:-translate-y-0.5 hover:shadow-md"
    >
      <p
        class="text-[10px] uppercase tracking-wide text-(--color-muted)"
      >
        {{ "dashboard.capacity" | translate }}
      </p>
      <div class="grid grid-cols-2 gap-2">
        <div>
          <p class="text-sm font-semibold text-(--color-text)">
            {{ building.lots }}
          </p>
          <p class="text-[11px] text-(--color-muted)">
            {{ "dashboard.lots" | translate }}
          </p>
        </div>
        <div>
          <p class="text-sm font-semibold text-(--color-text)">
            {{ building.residents?.length || 0 }}
          </p>
          <p class="text-[11px] text-(--color-muted)">
            {{ "dashboard.residents" | translate }}
          </p>
        </div>
      </div>
    </article>

    <article
      class="min-w-[200px] shrink-0 rounded-xl border  border-(--color-border) bg-(--color-surface) p-3 flex flex-col gap-2 transition-all duration-150 hover:-translate-y-0.5 hover:shadow-md"
    >
      <p
        class="text-[10px] uppercase tracking-wide text-(--color-muted)"
      >
        {{ "dashboard.building" | translate }}
      </p>
      <div class="grid grid-cols-2 gap-2">
        <div>
          <p class="text-sm font-semibold text-(--color-text)">
            {{ building.floors }}
          </p>
          <p class="text-[11px] text-(--color-muted)">
            {{ "dashboard.floors" | translate }}
          </p>
        </div>
        <div>
          <p class="text-sm font-semibold text-(--color-text)">
            {{ building.yearBuilt }}
          </p>
          <p class="text-[11px] text-(--color-muted)">
            {{ "dashboard.built" | translate }}
          </p>
        </div>
      </div>
    </article>

    
      <article
        class="rounded-xl border  border-(--color-border) bg-(--color-surface)
               p-3 flex flex-col gap-2 transition-all duration-150 hover:-translate-y-0.5 hover:shadow-md"
      >
        <p class="text-[10px] uppercase tracking-wide text-(--color-muted)">Confort</p>
        <div class="grid grid-cols-2 gap-2">
          <div>
            <p class="text-sm font-semibold text-(--color-text)">
              {{ building.elevator ? 'Oui' : 'Non' }}
            </p>
            <p class="text-[11px] text-(--color-muted)">Ascenseur</p>
          </div>
          <div>
            <p class="text-sm font-semibold text-(--color-text)">
              {{ building.works?.length || 0 }}
            </p>
            <p class="text-[11px] text-(--color-muted)">Travaux actifs</p>
          </div>
        </div>
      </article>
  </section>
  }

  <div class="grid gap-4 md:grid-cols-3">
    <!-- Column 1: Bulletins -->
    <section class="space-y-2">
      <div class="flex items-center justify-between gap-2">
        <h3
          class="text-xs font-semibold uppercase tracking-wide text-(--color-muted)"
        >
          {{ "dashboard.sections.bulletins" | translate }}
        </h3>
        @if (bulletins().length) {
        <div
          class="inline-flex items-center gap-2 rounded-lg border border-[color:var(--color-primary)] bg-[color:var(--color-bg)] px-3 py-1 shadow-sm"
        >
          <span
            class="flex h-7 w-7 items-center justify-center rounded-md bg-[color:var(--color-primary)] text-[11px] font-semibold text-white"
          >
            {{ bulletins().length }}
          </span>
          <div class="leading-tight">
            <p
              class="text-[10px] uppercase tracking-wide text-(--color-muted)"
            >
              {{ "dashboard.status.bulletins.label" | translate }}
            </p>
            <p
              class="text-xs font-semibold text-[color:var(--color-primary-600)]"
            >
              {{ "dashboard.status.bulletins.title" | translate }}
            </p>
          </div>
        </div>
        }
      </div>

      @if (bulletins().length) {
      <div class="space-y-2">
        @for (item of bulletins(); track item.id) {
        <app-dashboard-item-card
          class="px-1"
          [item]="item"
          [label]="getItemLabel(item.type) | translate"
          icon="üì¢"
          variant="primary"
          (tileAction)="onTileAction($event.action, $event.type, $event.id)"
        ></app-dashboard-item-card>
        }
      </div>
      } @else {
      <p class="text-xs text-(--color-muted)">
        {{ "dashboard.empty.bulletins" | translate }}
      </p>
      }
    </section>

    <!-- Column 2: Open issues -->
    <section class="space-y-2">
      <div class="flex items-center justify-between gap-2">
        <h3
          class="text-xs font-semibold uppercase tracking-wide text-(--color-muted)"
        >
          {{ "dashboard.sections.issues" | translate }}
        </h3>
        @if (openIssues().length) {
        <div
          class="inline-flex items-center gap-2 rounded-lg border border-[color:var(--color-danger)] bg-[color:var(--color-bg)] px-3 py-1 shadow-sm"
        >
          <span
            class="flex h-7 w-7 items-center justify-center rounded-md bg-[color:var(--color-danger)] text-[11px] font-semibold text-white"
          >
            {{ openIssues().length }}
          </span>
          <div class="leading-tight">
            <p
              class="text-[10px] uppercase tracking-wide text-(--color-muted)"
            >
              {{ "dashboard.status.issues.label" | translate }}
            </p>
            <p
              class="text-xs font-semibold text-[color:var(--color-danger-600,#dc2626)]"
            >
              {{ "dashboard.status.issues.title" | translate }}
            </p>
          </div>
        </div>
        }
      </div>

      @if (openIssues().length) {
      <div class="space-y-2">
        @for (item of openIssues(); track item.id) {
        <app-dashboard-item-card
          class="px-1"
          [item]="item"
          [label]="getItemLabel(item.type) | translate"
          icon="‚ö†Ô∏è"
          variant="danger"
          (tileAction)="onTileAction($event.action, $event.type, $event.id)"
        ></app-dashboard-item-card>
        }
      </div>
      } @else {
      <p class="text-xs text-(--color-muted)">
        {{ "dashboard.empty.issues" | translate }}
      </p>
      }
    </section>

    <!-- Column 3: Tasks -->
    <section class="space-y-2">
      <div class="flex items-center justify-between gap-2">
        <h3
          class="text-xs font-semibold uppercase tracking-wide text-(--color-muted)"
        >
          {{ "dashboard.sections.tasks" | translate }}
        </h3>
        @if (taskItems().length) {
        <div
          class="inline-flex items-center gap-2 rounded-lg border border-[color:var(--color-warning)] bg-[color:var(--color-bg)] px-3 py-1 shadow-sm"
        >
          <span
            class="flex h-7 w-7 items-center justify-center rounded-md bg-[color:var(--color-warning)] text-[11px] font-semibold text-white"
          >
            {{ taskItems().length }}
          </span>
          <div class="leading-tight">
            <p
              class="text-[10px] uppercase tracking-wide text-(--color-muted)"
            >
              {{ "dashboard.status.tasks.label" | translate }}
            </p>
            <p class="text-xs font-semibold text-[color:var(--color-warning)]">
              {{ "dashboard.status.tasks.title" | translate }}
            </p>
          </div>
        </div>
        }
      </div>

      @if (taskItems().length) {
      <div class="space-y-2">
        @for (item of taskItems(); track item.id) {
        <app-dashboard-item-card
          class="px-1"
          [item]="item"
          [label]="'dashboard.labels.task' | translate"
          icon="‚úÖ"
          variant="warning"
          [useTimeToDate]="true"
          (tileAction)="onTileAction($event.action, $event.type, $event.id)"
        ></app-dashboard-item-card>
        }
      </div>
      } @else {
      <p class="text-xs text-(--color-muted)">
        {{ "dashboard.empty.tasks" | translate }}
      </p>
      }
    </section>
  </div>
</section>
